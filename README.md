# RestakingHook

## 1. Overview

**RestakingHook** is a Uniswap v4 Hook that automatically restakes ETH when a liquidity position is inactive. It enhances yield generation by diverting idle ETH to a restaking contract and redistributing rewards to LPs based on a simulated APR model.

### Problem it solves:
- It ensures that idle liquidity is effectively utilized, generating rewards even when liquidity positions are inactive.

### How it works:
- The contract checks the status of the liquidity position and, if inactive, diverts ETH to a restaking contract (e.g., Lido).
- The rewards generated by the restaked ETH are then redistributed to liquidity providers (LPs).

## 2. Architecture

### Contract interactions:
- **BaseHook**: Inherited by RestakingHook to manage the liquidity.
- **Uniswap v4 PoolManager**: Interacts with Uniswap's pool to add/remove liquidity.
- **Restaking contracts (Lido)**: Interacts with external restaking contracts to maximize yield generation from idle ETH.

### Data structures used:
- **PoolKey**: Identifies the liquidity pool.
- **IPoolManager.ModifyLiquidityParams**: Parameters for liquidity adjustments.
- **Position**: Tracks user liquidity and restaking data.

### How liquidity, fees, and rewards are managed:
- Liquidity is added or removed based on the pool’s activity.
- ETH is restaked automatically when not in use.
- Rewards from restaked ETH are tracked and distributed to LPs.

## 3. Benefits

- **Maximized Yield**: By restaking idle liquidity, users earn additional rewards from their ETH even when it isn't actively contributing to a liquidity pool.
- **Automated Process**: The restaking of ETH happens automatically, reducing manual intervention for liquidity providers and ensuring they are always earning.
- **Increased Transparency**: The integration with restaking contracts (e.g., Lido) ensures that LPs can track their rewards and liquidity status with full transparency.
- **Efficient Liquidity Utilization**: Idle liquidity is redirected into yield-generating contracts, improving the efficiency of capital use in the ecosystem.

## 4. Architecture

### Contract interactions:
- **BaseHook**: Inherited by RestakingHook to manage the liquidity.
- **Uniswap v4 PoolManager**: Interacts with Uniswap's pool to add/remove liquidity.
- **Restaking contracts (Lido)**: Interacts with external restaking contracts to maximize yield generation from idle ETH.

### Data structures used:
- **PoolKey**: Identifies the liquidity pool.
- **IPoolManager.ModifyLiquidityParams**: Parameters for liquidity adjustments.
- **Position**: Tracks user liquidity and restaking data.

### How liquidity, fees, and rewards are managed:
- Liquidity is added or removed based on the pool’s activity.
- ETH is restaked automatically when not in use.
- Rewards from restaked ETH are tracked and distributed to LPs.

## 5. Example Workflow

1. A liquidity provider deposits ETH into a Uniswap v4 pool.
2. The liquidity provider's position becomes inactive due to low pool activity.
3. RestakingHook checks the position’s status and identifies that the liquidity is idle.
4. The smart contract automatically diverts the idle ETH to a restaking contract like Lido.
5. Rewards from restaked ETH are generated and automatically redistributed back to the liquidity provider.
6. The liquidity provider can see the rewards and status of their position via the platform's dashboard.

## 6. Future Improvements

- **Support for Other Restaking Contracts**: Expand compatibility with other restaking contracts to offer users more options.
- **Advanced Reward Models**: Implement more dynamic reward models to better simulate different APR scenarios and ensure fair distribution.
- **Enhanced Analytics**: Provide deeper analytics for LPs to monitor the performance of their restaked liquidity, including detailed yield reports and comparisons across multiple restaking options.
